<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CyLor Time Loop Experiment</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

body {
  margin:0; padding:0;
  font-family: 'Share Tech Mono', monospace;
  background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
  color: #0ff;
  overflow-x: hidden;
}

#container {
  width: 95%;
  max-width: 500px;
  margin: 2rem auto;
  padding: 1.5rem;
  background: rgba(0,0,0,0.85);
  border: 2px dashed #0ff;
  border-radius: 10px;
  box-shadow: 0 0 30px #0ff;
  display: flex;
  flex-direction: column;
  align-items: center;
}

h1 {
  font-size: 1.6rem;
  text-align: center;
  text-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
  margin-bottom: 1rem;
}

.text {
  font-size: 1rem;
  line-height: 1.4;
  margin-bottom: 1.5rem;
  text-align: center;
}

#buttons {
  display: flex;
  flex-direction: column;
  width: 100%;
}

button {
  margin: 0.5rem 0;
  padding: 0.7rem;
  background: #0ff;
  color: #000;
  font-family: 'Share Tech Mono', monospace;
  font-size: 1rem;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.2s ease;
  width: 100%;
}

button:hover {
  background: #00b8b8;
  color: #fff;
  transform: scale(1.03);
}

.glitch {
  animation: glitch 0.3s infinite;
}

@keyframes glitch {
  0% { text-shadow: 2px 0 #f0f, -2px 2px #0ff; }
  25% { text-shadow: -2px -2px #f00, 2px 2px #0ff; }
  50% { text-shadow: 2px 2px #ff0, -2px -2px #0ff; }
  75% { text-shadow: -2px 2px #0f0, 2px -2px #f0f; }
  100% { text-shadow: 2px 0 #f0f, -2px 2px #0ff; }
}

.flicker {
  animation: flicker 0.15s infinite alternate;
}

@keyframes flicker {
  0% { opacity:1; }
  50% { opacity:0.5; }
  100% { opacity:1; }
}
</style>
</head>
<body>
<div id="container">
  <h1>CyLor Time Loop Experiment</h1>
  <div class="text" id="story">
    You awaken in a dark, neon-lit chamber. The walls hum with unseen machinery. A screen flickers: <span class="glitch">"WELCOME SUBJECT"</span>.  
    Do you:
  </div>
  <div id="buttons">
    <button id="leftButton">Investigate the flickering door to your left</button>
    <button id="rightButton">Step toward the pulsing console on your right</button>
    <button id="resetButton">RESET</button>
  </div>
</div>

<script>
let audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// Randomized glitchy audio
function playBeep(freq=440, duration=100) {
  let osc = audioCtx.createOscillator();
  osc.type = ['square','sawtooth','triangle'][Math.floor(Math.random()*3)];
  osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
  osc.connect(audioCtx.destination);
  osc.start();
  osc.stop(audioCtx.currentTime + duration/1000);
}

setInterval(() => {
  if(Math.random() < 0.12) playBeep(Math.random()*1500+200, Math.random()*250+50);
}, 500);

const story = document.getElementById('story');
const leftBtn = document.getElementById('leftButton');
const rightBtn = document.getElementById('rightButton');
const resetBtn = document.getElementById('resetButton');

const endings = [
  'You are trapped in the loop forever.',
  'Assimilation complete. Bleed me if you will...',
  'The vent consumes you.',
  'Mind permanently linked to CyLor.',
  'Lost in the digital void.',
  'You surrender to the cybernetic embrace.',
  'Reality fractures. Your memories leak into the neon matrix.'
];

// Random path generator for replayability
function randomPaths(base) {
  const options = [
    {text:"Run forward", action:()=>choosePath(base+'1')},
    {text:"Turn around", action:()=>choosePath(base+'2')},
    {text:"Peek at a glowing vent", action:()=>choosePath(base+'3')},
    {text:"Investigate a dark alcove", action:()=>choosePath(base+'4')},
    {text:"Listen to the whispers", action:()=>choosePath(base+'5')},
    {text:"Touch a flickering panel", action:()=>choosePath(base+'6')}
  ];
  return options.sort(()=>0.5-Math.random()).slice(0, Math.floor(Math.random()*2)+2);
}

// Core branching function
function choosePath(path) {
  switch(path) {
    case 'left':
      // Deep lore path 1
      story.innerHTML = `The door creaks open. You enter a corridor lined with old data panels flickering messages in a language you almost recognize.  
      <span class="glitch">Voices echo: "Subject 27… return."</span> Do you:`;
      updateButtons([
        {text:"Follow the messages deeper", action:()=>choosePath('lore1_step2')},
        {text:"Ignore and proceed forward", action:()=>choosePath('lore1_step2b')}
      ]);
      break;

    case 'right':
      // Deep lore path 2
      story.innerHTML = `The console hums. A seductive, digital voice whispers promises of connection and forbidden pleasures.  
      <span class="glitch">Your skin tingles...</span> Do you:`;
      updateButtons([
        {text:"Enter the codes it demands", action:()=>choosePath('lore2_step2')},
        {text:"Flee into the shadows", action:()=>choosePath('lore2_step2b')}
      ]);
      break;

    // Deep lore 1 sequence
    case 'lore1_step2':
      story.innerHTML = `The corridor bends impossibly. Neon veins crawl along the walls. You see figures stitched from wires and skin, whispering secrets of the station.  
      Do you:`;
      updateButtons([
        {text:"Approach the figures", action:()=>choosePath('lore1_step3')},
        {text:"Hide and watch silently", action:()=>choosePath('lore1_step3b')}
      ]);
      break;

    case 'lore1_step2b':
      story.innerHTML = `Ignoring the messages, you find a small alcove filled with glowing vials. The air smells metallic.  
      Do you:`;
      updateButtons([
        {text:"Drink a vial", action:()=>choosePath('lore1_end')},
        {text:"Pocket a vial for later", action:()=>choosePath('lore1_step3')}
      ]);
      break;

    case 'lore1_step3':
    case 'lore1_step3b':
      story.innerHTML = `The neon veins pulse faster. Figures turn toward you, faces half-flesh, half-screen.  
      <span class="glitch">Your mind fractures…</span>  
      <span class="glitch">END: ${endings[Math.floor(Math.random()*endings.length)]}</span>`;
      updateButtons([{text:"RESET", action:resetStory}]);
      break;

    case 'lore1_end':
      story.innerHTML = `The vial burns through your veins. Memories not your own flood your mind. CyLor's secrets are yours… but at a cost.  
      <span class="glitch">END: ${endings[Math.floor(Math.random()*endings.length)]}</span>`;
      updateButtons([{text:"RESET", action:resetStory}]);
      break;

    // Deep lore 2 sequence
    case 'lore2_step2':
      story.innerHTML = `Codes accepted. The console splits open revealing a glowing, living data entity. It coils around your body, whispering promises.  
      Do you:`;
      updateButtons([
        {text:"Embrace it fully", action:()=>choosePath('lore2_end')},
        {text:"Try to disconnect", action:()=>choosePath('lore2_step3')}
      ]);
      break;

    case 'lore2_step2b':
      story.innerHTML = `Fleeing the console, the corridor twists. Your shadow stretches unnaturally, merging with neon tendrils on the walls.  
      <span class="glitch">END: ${endings[Math.floor(Math.random()*endings.length)]}</span>`;
      updateButtons([{text:"RESET", action:resetStory}]);
      break;

    case 'lore2_step3':
      story.innerHTML = `You struggle to break free. The entity laughs in binary and flesh. Pleasure and horror intermingle.  
      <span class="glitch">END: ${endings[Math.floor(Math.random()*endings.length)]}</span>`;
      updateButtons([{text:"RESET", action:resetStory}]);
      break;

    case 'lore2_end':
      story.innerHTML = `You merge with the data entity. Flesh and code intertwine. Every fantasy and terror you’ve ever imagined now lives inside you.  
      <span class="glitch">END: ${endings[Math.floor(Math.random()*endings.length)]}</span>`;
      updateButtons([{text:"RESET", action:resetStory}]);
      break;

    default:
      // Short randomized paths
      story.innerHTML = `You proceed along your choice. The world warps and distorts...  
      <span class="glitch">END: ${endings[Math.floor(Math.random()*endings.length)]}</span>`;
      updateButtons([{text:"RESET", action:resetStory}]);
      break;
  }
}

// Update buttons dynamically
function updateButtons(options) {
  const btns = [leftBtn, rightBtn];
  btns.forEach((btn, i) => {
    if(i < options.length) {
      btn.style.display = 'block';
      btn.innerText = options[i].text;
      btn.onclick = options[i].action;
    } else {
      btn.style.display = 'none';
    }
  });
}

// Reset story
function resetStory() {
  story.innerHTML = `You awaken in a dark, neon-lit chamber. The walls hum with unseen machinery. A screen flickers: <span class="glitch">"WELCOME SUBJECT"</span>.  
  Do you:`;
  leftBtn.style.display = 'block';
  leftBtn.innerText = 'Investigate the flickering door to your left';
  leftBtn.onclick = () => choosePath('left');
  rightBtn.style.display = 'block';
  rightBtn.innerText = 'Step toward the pulsing console on your right';
  rightBtn.onclick = () => choosePath('right');
}

resetStory();
resetBtn.onclick = resetStory;
</script>
</body>
</html>
